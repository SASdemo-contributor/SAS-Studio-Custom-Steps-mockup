{"creationTimeStamp":"2022-08-24T12:00:05.225Z","modifiedTimeStamp":"2022-08-24T14:09:38.552Z","createdBy":"sasdemo","modifiedBy":"sasdemo","name":"Rank Columns - Starter template.step","displayName":"Rank Columns - Starter template.step","localDisplayName":"Rank Columns - Starter template.step","properties":{},"links":[{"method":"GET","rel":"self","href":"/dataFlows/steps/49400789-79ba-4416-b3a3-a20bea97583f","uri":"/dataFlows/steps/49400789-79ba-4416-b3a3-a20bea97583f","type":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"alternate","href":"/dataFlows/steps/49400789-79ba-4416-b3a3-a20bea97583f","uri":"/dataFlows/steps/49400789-79ba-4416-b3a3-a20bea97583f","type":"application/vnd.sas.data.flow.step.summary"},{"method":"GET","rel":"up","href":"/dataFlows/steps","uri":"/dataFlows/steps","type":"application/vnd.sas.collection","itemType":"application/vnd.sas.data.flow.step.summary"},{"method":"PUT","rel":"update","href":"/dataFlows/steps/49400789-79ba-4416-b3a3-a20bea97583f","uri":"/dataFlows/steps/49400789-79ba-4416-b3a3-a20bea97583f","type":"application/vnd.sas.data.flow.step","responseType":"application/vnd.sas.data.flow.step"},{"method":"DELETE","rel":"delete","href":"/dataFlows/steps/49400789-79ba-4416-b3a3-a20bea97583f","uri":"/dataFlows/steps/49400789-79ba-4416-b3a3-a20bea97583f"},{"method":"GET","rel":"transferExport","href":"/dataFlows/steps/49400789-79ba-4416-b3a3-a20bea97583f","uri":"/dataFlows/steps/49400789-79ba-4416-b3a3-a20bea97583f","responseType":"application/vnd.sas.transfer.object"},{"method":"PUT","rel":"transferImportUpdate","href":"/dataFlows/steps/49400789-79ba-4416-b3a3-a20bea97583f","uri":"/dataFlows/steps/49400789-79ba-4416-b3a3-a20bea97583f","type":"application/vnd.sas.transfer.object","responseType":"application/vnd.sas.summary"}],"metadataVersion":0.0,"version":2,"type":"code","flowMetadata":{"inputPorts":[{"name":"inTable","displayName":"Input table","localDisplayName":"Input table","description":"Source table","localDescription":"Source table","minEntries":1,"maxEntries":1,"type":"table"}],"outputPorts":[{"name":"outTable","displayName":"Output table","localDisplayName":"Output table","description":"Output table","localDescription":"Output table","minEntries":1,"maxEntries":1,"type":"table","requiresStructure":false}]},"ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"pageRankOptions\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Rank Options\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"inTable\",\n\t\t\t\t\t\"type\": \"inputtable\",\n\t\t\t\t\t\"label\": \"Select an input table:\",\n\t\t\t\t\t\"required\": true\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"rankColumns\",\n\t\t\t\t\t\"type\": \"columnselector\",\n\t\t\t\t\t\"label\": \"Select columns to rank:\",\n\t\t\t\t\t\"table\": \"inTable\",\n\t\t\t\t\t\"columntype\": \"n\",\n\t\t\t\t\t\"min\": 1\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"ties\",\n\t\t\t\t\t\"type\": \"dropdown\",\n\t\t\t\t\t\"label\": \"Select how to handle tied values:\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"High\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"Low\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"Mean\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"Dense\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"required\": true\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"outTable\",\n\t\t\t\t\t\"type\": \"outputtable\",\n\t\t\t\t\t\"label\": \"Specify the output table:\",\n\t\t\t\t\t\"required\": true\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"createNewVariables\",\n\t\t\t\t\t\"type\": \"checkbox\",\n\t\t\t\t\t\"label\": \"Create new columns for each of the ranked columns\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"pageAbout\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"About\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"textAbout\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"The \\\"Rank Columns - Starter template\\\" step computes ranks for one or more numeric columns across all records of a table and writes the ranks to a new table.\\n\\nThe following options are supported to specify how to rank tied values: HIGH | LOW | MEAN (default) | DENSE. More details can be found in SAS Viya Programming Documentation - RANK Procedure.\\n\\nBy default, the values in the selected columns to rank are overwritten with the calculated rank. When selecting the option to create new columns, the new column names will use the input column name prefixed with \\\"rank_\\\". \\n\\nAnd indeed, this custom step is very similar to the Advanced Rank step that can be found in the Starter templates in SAS Studio itself (Steps panel ->  button \\\"New and sample custom steps\\\").\\n\\n\\nVersion: 1.0 (25AUG2022)\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"ties\": {\n\t\t\t\"value\": \"Mean\"\n\t\t},\n\t\t\"createNewVariables\": true\n\t}\n}","templates":{"SAS":"/*************************************************************\nPROC RANK for multiple columns and additional option.\n*************************************************************/\n\n/* Example of using a macro to loop through a variable set of\n   values from a control to build a list of values. */\n\n%let columnsToRankList=;\n%let newColumnsList=;\n\n/* Name of the UI control that shows the list of selected columns\n   is: rankColumns */\n%macro columnSelectorToSingleMacrovar; \n     %do i = 1 %to &rankColumns_count;\n         %let columnsToRankList= &columnsToRankList &&rankColumns_&i._name;\n         %if &createNewVariables=1 %then %do;\n             %let newColumnsList=&newColumnsList rank_&&rankColumns_&i._name;\n         %end;\n     %end;\n%mend columnSelectorToSingleMacrovar;\n\n%columnSelectorToSingleMacrovar;\n\n/* Take all of the input and put together the final code */\nproc rank data=&inTable out=&outTable ties=&ties;\n    var &columnsToRankList;\n    %if &createNewVariables=1 %then %do;\n        ranks &newColumnsList;\n     %end;\nrun;\n\n/* Cleanup macros and macro variables that were created in this\n   user-defined code generator, using standard macros that are generated\n   by the SAS Studio Flow framework. \n   The definition of these macros can be seen in the generated code when\n   a custom step is run in Flow mode or run in Standalone mode. */\n%_flw_del_macro_vars(columnsToRankList newColumnsList);\n%_flw_del_macros(columnSelectorToSingleMacrovar);\n"}}
